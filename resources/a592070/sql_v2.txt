/*
更新 ATTRACTION table 需要重新匯入csv
刪除 attractions_set TRAFFIC_SET restaurant_set hotel_set travel_set_1day travel_set_2day
新增 
TRAVEL_SET
TRAVEL_ELE_C
TRAVEL_ELE_R
TRAVEL_ELE_H
order_data
order_table
*/
/*
drop table ATTRACTION
drop table travel_set_2day
drop table travel_set_1day
drop table hotel_set
drop table restaurant_set
drop table TRAFFIC_SET
drop table attractions_set
*/

create table ATTRACTION
(
    A_SN            number generated as identity
        constraint ATTRACTION_PK
            primary key,
    NAME           VARCHAR2(255),
    TOLDESCRIBE    NVARCHAR2(2000),
    DESCRIPTION    NVARCHAR2(2000),
    TEL            VARCHAR2(255),
    ADDRESS        VARCHAR2(1024),
    REGION         VARCHAR2(255),
    TRAVELLINGINFO VARCHAR2(1024),
    OPENTIME       VARCHAR2(1024),
    PICTURE        VARCHAR2(1024),
    PX             NUMBER(10, 7),
    PY             NUMBER(10, 7),
    TICKETINFO     VARCHAR2(1024),
    KEYWORDS       VARCHAR2(1024),
    REMARKS        VARCHAR2(1024),
    RATING         NUMBER(2, 1)
)

insert into ACCOUNT(username, password, IDENTITY, MODIFY_DATE, REGISTER)
values ('system', 'system', 1, to_date(sysdate), to_date(sysdate));

/* 行程table system 代表推薦行程 */
create table TRAVEL_SET
(
    SN      NUMBER generated as identity
        constraint TRAVEL_SET_PK
            primary key,
    CREATED VARCHAR2(255) default 'system'
        constraint TRAVEL_SET_ACCOUNT_USERNAME_FK
            references ACCOUNT default 'system'
)
/* 行程中的租車規劃 */
create table TRAVEL_ELE_C
(
    SN        NUMBER generated as identity
        constraint TRAVEL_ELE_C_PK
            primary key,
    TRAVEL_ID NUMBER not null
        constraint TRAVEL_ELE_C_TRAVEL_SET_SN_FK
            references TRAVEL_SET,
    C_ID      NUMBER not null
        constraint TRAVEL_ELE_C_CARTYPE_SN_CARTYPE_FK
            references CARTYPE,
    TIME      TIMESTAMP(6)
)
/* 行程中的餐廳規劃 */
create table TRAVEL_ELE_R
(
    SN        NUMBER generated as identity
        constraint TRAVEL_ELE_R_PK
            primary key,
    TRAVEL_ID NUMBER not null
        constraint TRAVEL_ELE_R_TRAVEL_SET_SN_FK
            references TRAVEL_SET,
    R_ID      NUMBER not null
        constraint TRAVEL_ELE_R_RESTAURANT_R_SN_FK
            references RESTAURANT,
    TIME      TIMESTAMP(6)
)
/* 行程中的旅館規劃 */
create table TRAVEL_ELE_H
(
    SN        NUMBER generated as identity
        constraint TRAVEL_ELE_H_PK
            primary key,
    TRAVEL_ID NUMBER not null
        constraint TRAVEL_ELE_H_TRAVEL_SET_SN_FK
            references TRAVEL_SET,
    H_ID      NUMBER not null
        constraint TRAVEL_ELE_H_HOTEL_SN_FK
            references HOTEL,
    TIME      TIMESTAMP(6)
)
/* 行程中的景點規劃 */
create table TRAVEL_ELE_A
(
    SN        NUMBER generated as identity
        constraint TRAVEL_ELE_A_PK
            primary key,
    TRAVEL_ID NUMBER not null
        constraint TRAVEL_ELE_A_TRAVEL_SET_SN_FK
            references TRAVEL_SET,
    A_ID      NUMBER not null
        constraint TRAVEL_ELE_A_ATTRACTION_A_SN_FK
            references ATTRACTION,
    TIME      TIMESTAMP(6)
)


/* 訂單個人資料 */
create table order_data
(
        sn number generated as identity
                constraint ORDER_DATA_PK
                        primary key,
        username varchar2(255) not null
                constraint ORDER_DATA_ACCOUNT_USERNAME_FK
                        references ACCOUNT,
        name varchar2(255) not null,
        phone varchar2(255) not null
)
/* 訂單總表 */
create table order_table
(
        order_id number generated as identity
                constraint ORDER_TABLE_PK
                        primary key,
        price number default 0 not null,
        order_date timestamp default sysdate,
        sn_no number
                constraint ORDER_TABLE_ORDER_DATA_SN_FK
                        references ORDER_DATA
)